{"version":3,"sources":["webpack:///src/components/uploadImg.vue","webpack:///./src/components/uploadImg.vue?e47e","webpack:///./src/components/uploadImg.vue"],"names":["uploadImg","props","urls","type","Array","default","data","cropperVisible","option","img","info","outputSize","outputType","canScale","autoCrop","autoCropWidth","autoCropHeight","fixedBox","fixed","fixedNumber","full","canMoveBox","original","centerBox","infoTrue","loading","files","methods","delteImg","idx","params","path","this","split","splice","Object","dy","then","res","upload","e","_this","target","formData","FormData","i","length","append","imgs","map","v","push","url","concat","$emit","finish","_this2","$refs","cropper","getCropBlob","console","log","fileinfo","lastModified","lastModifiedDate","name","webkitRelativePath","components_uploadImg","render","_vm","_h","$createElement","_c","_self","staticClass","_l","key","attrs","src","fit","_v","on","click","$event","_e","multiple","change","title","visible","width","append-to-body","update:visible","staticStyle","text-align","ref","size","canMove","realTime","slot","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/10.d219e78f071ff5f8a5ee.js","sourcesContent":["<template>\r\n  <div class=\"upload-img\">\r\n    <div class=\"img-list flex-row\" v-if=\"urls.length>0\">\r\n      <div class=\"img-item\" v-for=\"(v,i) in urls\" :key=\"i\">\r\n        <el-image :src=\"v\" fit=\"contain\" class=\"img\"/>\r\n        <i class=\"el-icon-close icon-delete\" @click=\"delteImg(i)\"></i>\r\n      </div>\r\n    </div>\r\n    <input type=\"file\" multiple @change=\"upload\">\r\n    <!-- vueCropper 剪裁图片实现-->\r\n    <el-dialog title=\"图片剪裁\" :visible.sync=\"cropperVisible\" width=\"1040px\" append-to-body>\r\n      <div class=\"cropper-content\">\r\n        <div class=\"cropper\" style=\"text-align:center\">\r\n          <vueCropper\r\n            ref=\"cropper\"\r\n            :img=\"option.img\"\r\n            :outputSize=\"option.size\"\r\n            :outputType=\"option.outputType\"\r\n            :info=\"true\"\r\n            :full=\"option.full\"\r\n            :canMove=\"option.canMove\"\r\n            :canMoveBox=\"option.canMoveBox\"\r\n            :original=\"option.original\"\r\n            :autoCrop=\"option.autoCrop\"\r\n            :fixed=\"option.fixed\"\r\n            :fixedNumber=\"option.fixedNumber\"\r\n            :centerBox=\"option.centerBox\"\r\n            :infoTrue=\"option.infoTrue\"\r\n            :fixedBox=\"option.fixedBox\"\r\n            @realTime=\"realTime\"\r\n          ></vueCropper>\r\n        </div>\r\n      </div>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button size=\"small\" @click=\"cropperVisible = false\">取 消</el-button>\r\n        <el-button size=\"small\" type=\"primary\" @click=\"finish\" :loading=\"loading\">确认</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { multiUpload, delFile } from \"../api/dy\";\r\nexport default {\r\n  props: {\r\n    urls: {\r\n      type: Array,\r\n      default: []\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      cropperVisible: false,\r\n      // 裁剪组件的基础配置option\r\n      option: {\r\n        img: \"\", // 裁剪图片的地址\r\n        info: true, // 裁剪框的大小信息\r\n        outputSize: 1, // 裁剪生成图片的质量\r\n        outputType: \"jpeg\", // 裁剪生成图片的格式\r\n        canScale: true, // 图片是否允许滚轮缩放\r\n        autoCrop: true, // 是否默认生成截图框\r\n        autoCropWidth: 800, // 默认生成截图框宽度\r\n        autoCropHeight: 800, // 默认生成截图框高度\r\n        fixedBox: false, // 固定截图框大小 不允许改变\r\n        fixed: true, // 是否开启截图框宽高固定比例\r\n        fixedNumber: [1, 1], // 截图框的宽高比例\r\n        full: false, // 是否输出原图比例的截图\r\n        canMoveBox: true, // 截图框能否拖动\r\n        original: true, // 上传图片按照原始比例渲染\r\n        centerBox: false, // 截图框是否被限制在图片里面\r\n        infoTrue: true // true 为展示真实输出图片宽高 false 展示看到的截图框宽高\r\n      },\r\n      loading: false,\r\n      files: null\r\n    };\r\n  },\r\n  methods: {\r\n    delteImg(idx) {\r\n      var params={\r\n        path:this.urls[idx].split('uploads/')[1]\r\n      }\r\n      this.urls.splice(idx, 1);\r\n      delFile(params).then(res=>{})\r\n    },\r\n    upload(e) {\r\n      var files = e.target.files;\r\n      var formData = new FormData();\r\n      for (var i = 0; i < files.length; i++) {\r\n        formData.append(\"image[]\", files[i]);\r\n      }\r\n      multiUpload(formData).then(res => {\r\n        if (res.data.length > 0) {\r\n          var imgs = [];\r\n          res.data.map(v => {\r\n            imgs.push(v.url);\r\n          });\r\n          this.urls = this.urls.concat(imgs);\r\n          this.$emit(\"transferUrls\", this.urls);\r\n        }\r\n      });\r\n      // this.files=files\r\n      //   console.log(files)\r\n      // this.fileinfo = files[0];\r\n      // let _URL = window.URL || window.webkitURL;\r\n      // let img = new Image();\r\n      // img.src = _URL.createObjectURL(this.fileinfo);\r\n      // this.$nextTick(() => {\r\n      //   this.option.img = img.src;\r\n      //   this.cropperVisible = true;\r\n      //   this.loading = false;\r\n      // });\r\n    },\r\n    // 点击裁剪，这一步是可以拿到处理后的地址\r\n    finish() {\r\n      this.$refs.cropper.getCropBlob(data => {\r\n        console.log(data, this.fileinfo);\r\n        data.lastModified = this.fileinfo.lastModified;\r\n        data.lastModifiedDate = this.fileinfo.lastModifiedDate;\r\n        data.name = this.fileinfo.name;\r\n        data.webkitRelativePath = this.fileinfo.webkitRelativePath;\r\n        var formData = new FormData();\r\n        for (var i = 0; i < this.files.length; i++) {\r\n          if (i == 0) {\r\n            formData.append(\"image[]\", data);\r\n          } else {\r\n            formData.append(\"image[]\", this.files[i]);\r\n          }\r\n        }\r\n\r\n        multiUpload(formData).then(res => {\r\n          if (res.data.length > 0) {\r\n            var imgs = [];\r\n            res.data.map(v => {\r\n              imgs.push(v.url);\r\n            });\r\n            this.urls = this.urls.concat(imgs);\r\n            this.$emit(\"transferUrls\", this.urls);\r\n          }\r\n        });\r\n        // var fileName = \"goods\" + this.fileinfo.lastModified;\r\n        // this.loading = true;\r\n        // data.uid = this.fileinfo.uid;\r\n        // console.log(data);\r\n        // const imgSize = data.size / 1024;\r\n        // if (imgSize > 500) {\r\n        //   this.$message.error(\"上传图片大小不能超过 500kb!\");\r\n        //   this.loading = false;\r\n        //   return false;\r\n        // }\r\n        // let formData = new FormData();\r\n        // formData.append(\"file\", data);\r\n        // qiuniuUpToken(formData).then(res => {\r\n        //   this.loading = false;\r\n        //   this.cropperVisible = false;\r\n        //   this.$emit(\"transferUrl\", res);\r\n        // });\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.img-list {\r\n  justify-content: flex-start;\r\n  .img-item {\r\n    width: 100px;\r\n    height: 100px;\r\n    background: #eee;\r\n    margin-right: 10px;\r\n    position: relative;\r\n    .img {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n    .icon-delete {\r\n      position: absolute;\r\n      right: 0;\r\n      top: 0;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n}\r\n// 截图\r\n.cropper-content {\r\n  .cropper {\r\n    width: 1000px;\r\n    height: 480px;\r\n  }\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/uploadImg.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"upload-img\"},[(_vm.urls.length>0)?_c('div',{staticClass:\"img-list flex-row\"},_vm._l((_vm.urls),function(v,i){return _c('div',{key:i,staticClass:\"img-item\"},[_c('el-image',{staticClass:\"img\",attrs:{\"src\":v,\"fit\":\"contain\"}}),_vm._v(\" \"),_c('i',{staticClass:\"el-icon-close icon-delete\",on:{\"click\":function($event){_vm.delteImg(i)}}})],1)}),0):_vm._e(),_vm._v(\" \"),_c('input',{attrs:{\"type\":\"file\",\"multiple\":\"\"},on:{\"change\":_vm.upload}}),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"图片剪裁\",\"visible\":_vm.cropperVisible,\"width\":\"1040px\",\"append-to-body\":\"\"},on:{\"update:visible\":function($event){_vm.cropperVisible=$event}}},[_c('div',{staticClass:\"cropper-content\"},[_c('div',{staticClass:\"cropper\",staticStyle:{\"text-align\":\"center\"}},[_c('vueCropper',{ref:\"cropper\",attrs:{\"img\":_vm.option.img,\"outputSize\":_vm.option.size,\"outputType\":_vm.option.outputType,\"info\":true,\"full\":_vm.option.full,\"canMove\":_vm.option.canMove,\"canMoveBox\":_vm.option.canMoveBox,\"original\":_vm.option.original,\"autoCrop\":_vm.option.autoCrop,\"fixed\":_vm.option.fixed,\"fixedNumber\":_vm.option.fixedNumber,\"centerBox\":_vm.option.centerBox,\"infoTrue\":_vm.option.infoTrue,\"fixedBox\":_vm.option.fixedBox},on:{\"realTime\":_vm.realTime}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":function($event){_vm.cropperVisible = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\",\"loading\":_vm.loading},on:{\"click\":_vm.finish}},[_vm._v(\"确认\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5ee71ad3\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/uploadImg.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5ee71ad3\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./uploadImg.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./uploadImg.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./uploadImg.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5ee71ad3\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./uploadImg.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5ee71ad3\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/uploadImg.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}